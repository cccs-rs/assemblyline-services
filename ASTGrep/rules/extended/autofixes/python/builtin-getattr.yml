# yaml-language-server: $schema=https://raw.githubusercontent.com/ast-grep/ast-grep/main/schemas/rule.json

id: python-builtin-getattr
message: Uses getattr to obfuscate using a builtin function
language: Python
rule:
  any:
    - pattern:
        context: getattr(__import__("builtins"), "$DATA")
        strictness: signature

fix: $DATA

metadata:
  extended-obfuscation: yes
  confirmed-obfuscation: yes

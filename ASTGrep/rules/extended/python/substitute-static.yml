# yaml-language-server: $schema=https://raw.githubusercontent.com/ast-grep/ast-grep/main/schemas/rule.json

id: python-substitute-static-vars
message: Substitute static variables
language: Python
rule:
  kind: assignment
  all:
    - has:
        field: left
        kind: identifier
        pattern: $VAR
    - has:
        field: right
        pattern: $VALUE
        any:
          - kind: integer
          - kind: string
    - not:
        inside:
          kind: function_definition
          stopBy: end

metadata:
  extended-obfuscation: no
  alone-unimportant: yes
  template_file: python-replace-static-var.yml.j2
  deobfuscate: |
    {
      "type": "template",
      "steps": [],
      "fix-key": "VAR",
      "override-fix": true
    }
